{% extends 'base.html.twig' %}

{% block title %}
	Commande |
	{{ parent() }}
{% endblock %}

{# START : purchase #}
{% block body %}
	<main>
		<section class="page">
			<h2>Commande</h2>
			{{ form_start(purchaseForm, { 'attr': { 'novalidate': 'novalidate', 'class': 'form form-purchase', 'id': 'purchase-form' }}) }}
			<h3 class="page__title-purchase-step page__title-address-step page__purchase-step" id="addresses-step">1 - Adresses üìÆ
				<img class="display-none page__icon page__icon-checked page__icon_color_green" id="icon-checked-addresses-step" src="{{ asset('assets/images/icons/check-mark.svg') }}" alt="icon-checked"/>
			</h3>
			{# billingAddress #}
			<div class="form-field form-field-address form-field-purchase-billing-address">
				{{ form_label(purchaseForm, 'Adresse de facturation :', { 'label_attr': { 'class': 'form-field__label' }}) }}
				{{ form_widget(purchaseForm.billingAddress)|replace({"[br]":"</br>"})|raw }}
				<p class="error-message error-message_color_red error-message__billing-address-not-checked display-none">
					Merci de s√©lectionner une adresse de facturation.
				</p>
				{{ form_errors(purchaseForm.billingAddress) }}
			</div>
			{# deliveryAddress #}
			<div class="form-field form-field-address form-field-purchase-delivery-address">
				{{ form_label(purchaseForm, 'Adresse de livraison :', { 'label_attr': { 'class': 'form-field__label' }}) }}
				{{ form_widget(purchaseForm.deliveryAddress)|replace({"[br]":"</br>"})|raw  }}
				<p class="error-message error-message_color_red error-message__delivery-address-not-checked display-none">
					Merci de s√©lectionner une adresse de livraison.
				</p>
				{{ form_errors(purchaseForm.deliveryAddress) }}
			</div>
			<a class="page__link page__link_text_normal page__purchase-step page__link_color_blue page__link_padding-and-margin_0" id="add-new-address-link" href="{{ path('address_create') }}?returnToPurchase=true">
				+ Ajouter une nouvelle adresse.</a>
			<button type="button" class="page__purchase-step page__button page__button_background-color_blue page__button_color_white" id="purchase-confirm-address-button">
				Continuer
			</button>
			<h3 class="page__title-purchase-step page__title-delivery-mode-step page__purchase-step page__title-purchase-step_color_shady-lady" id="delivery-mode-step">2 - Mode de livraison üì¶
				<img class="display-none page__icon page__icon_color_green page__icon-checked " id="icon-checked-delivery-mode-step" src="{{ asset('assets/images/icons/check-mark.svg') }}" alt="icon-checked"/>
			</h3>
			{# deliveryMode #}
			<div class="form-field form-field-purchase-delivery-mode display-none" data-folderpath={{ deliveryModePictureUploadFolderPath }} data-pictures={{ deliveryModePictures|json_encode }}>
				{{ form_label(purchaseForm, 'Mode de livraison :', { 'label_attr': { 'class': 'display-none' }}) }}
				{{ form_widget(purchaseForm.deliveryMode) }}
				{# {{ form_widget(purchaseForm.deliveryMode)|replace({"[img]":"<img>" })|raw }} #}
				<p class="error-message error-message_color_red error-message__purchase-delivery-mode-not-checked display-none">
					Merci de s√©lectionner un mode de livraison.
				</p>
				{{ form_errors(purchaseForm.deliveryMode) }}
			</div>
			<button type="button" class="page__purchase-step page__button page__button_background-color_blue page__button_color_white display-none" id="purchase-confirm-delivery-mode-button">
				Continuer
			</button>
			<h3 class="page__title-purchase-step page__title-payment-method-step page__purchase-step page__title-purchase-step_color_shady-lady" id="payment-method-step">3 - Paiement S√©curis√© üîê</h3>
			{# paymentMethod #}
			<div class="form-field form-field-purchase-checkout-method display-none">
				{#! TODO #3 START : Make Paypal checkout.  #}
				{# Paypal #}
				{# {{ paypalCheckout.showUserInterface()|raw }} #}
				{#! TODO #3 END : Paypal checkout  #}
				{{ form_label(purchaseForm, 'Mode de paiment :', { 'label_attr': { 'class': 'display-none' }}
				) }}
				{{ form_widget(purchaseForm.checkoutMethod) }}
					<p class="error-message error-message_color_red error-message__purchase-payment-method-not-checked display-none"> Merci de s√©lectionner un moyen de paiement.
				</p>
				{{ form_errors(purchaseForm.checkoutMethod) }}
			</div>
			{# agreeTerms #}
			<div class="form-field form-field-purchase-terms-of-sale display-none">
				{{ form_widget(purchaseForm.agreeTerms, { 'id': 'purchase-terms-of-sale-input', 'attr': {'class': 'form-field__input-terms-of-sale' }}) }}
				{{ form_label(purchaseForm, 'J\'ai lu et j\'accepte les ', { 'label_attr': { 'class': '' }}) }}
				<a class="page__link page__link_color_blue page__link_text_underline page__link_padding-and-margin_0" id="terms-of-service-link" href="{{ path('terms_of_sales') }}">Conditions G√©n√©rales de Vente</a>.
				<p class="error-message error-message_color_red         error-message__terms-of-sale-not-checked display-none">
					Merci de confirmer avoir lu et accepter nos Conditions G√©n√©rales de Vente.
				</p>
				{{ form_errors(purchaseForm.agreeTerms) }}
			</div>
			{#  Submit purchaseForm button #}
			<button type="button" class="page__purchase-step page__button page__button_background-color_blue page__button_color_white display-none" id="purchase-confirm-button">COMMANDER</button>
			{{ form_end(purchaseForm) }}
			{# END : purchaseForm #}
			{# <a class="display-none" id="stripe-checkout-link" href="{{ path('purchase_stripe_checkout') }}"></a>. #}
				<h4 class="page__title-your-cart"> Votre Panier</h4>
			{% for item in cartItems %}
				<div class="purchase-item-reminder" id="desktop-purchase-item">
					<div class="purchase-item-property-reminder">
						<h3>{{ item.product.name }}</h3>
						<p>{{ item.product.price|amount }}</p>
						<p>
							Quantit√© x
							{{ item.quantity }}
						</p>
						<p>{{ item.total|amount }}</p>
					</div>
				</div>
			{% endfor %}
			<div class="purchase-subtotal-reminder" id="desktop-purchase-subtotal">
				<p>Sous-total :</p>
				<p id="purchase-subtotal-paragraph" data-purchasesubtotal="{{ subtotal }}">{{ subtotal|amount }}</p>
			</div>
			<div class="purchase-delivery-mode-price-reminder" id="desktop-purchase-delivery-mode-price">
				<p>Frais de livraison :</p>
				<p id="purchase-delivery-mode-price-paragraph" data-deliveryamountfree="{{ deliveryPriceFree|amount }}" data-deliverymodebydefaultprice="{{ deliveryModePrice }}" data-deliverymodebydefaultamount="{{ deliveryModePrice|amount }}"></p>
			</div>
			<div class="purchase-total-reminder purchase-total_border-color_blue" id="desktop-purchase-total">
				<p>TOTAL :</p>
				<p id="purchase-total-paragraph" data-total="{{ total|amount }}"></p>
			</div>
		</section>
	</main>
{% endblock %}
{# END : purchase #}
