{% extends 'base.html.twig' %}

{% block title %}
	Commandes -
	{{ app.user.firstName }}
	{{ app.user.lastName }}
	|
	{{ parent() }}
{% endblock %}

{# START : purchase_list #}
{% block body %}
	<main>
		<section class="page">
			<h2>Mes Commandes</h2>
			{# START : searchPurchaseForm #}
			{{ form_start(searchPurchaseForm, { 'attr': { 'novalidate': 'novalidate', 'class': 'form', 'id': 'search-purchase-form' }}
			) }}
			<div class="form-field">
				{{ form_label(searchPurchaseForm, 'R√©f√©rence', { 'label_attr': { 'class': 'display-none' }}) }}
				{{ form_widget(searchPurchaseForm.reference, { 'id': '', 'attr': {'class': 'form-field__input form-field__input_color_black form-field__input-search form-field__input-purchase-reference', 'placeholder': 'üîç Rechercher par r√©f√©rence' }}) }}
				<p class="error-message error-message_color_red error-message__purchase-reference-empty display-none">
					Merci de saisir une r√©f√©rence.
				</p>
				<p class="error-message error-message_color_red error-message__purchase-reference-length display-none">
					La r√©f√©rence doit contenir 12 cact√®res.
				</p>
				{{ form_errors(searchPurchaseForm.reference) }}
			</div>
			<button type="submit" class="page__button page__button-submit page__button-search page__button_background-color_blue page__button_color_white" id="search-purchase-button">
				Rechercher
			</button>
			{{ form_end(searchPurchaseForm) }}
			{# END : searchPurchaseForm #}
			<div
				class="list">
				{# START : card for mobile #}
				{% for purchase in purchases %}
					<div class="card-purchase card-purchase_border-color_blue">
						<p>
							{{ purchase.reference|upper }}
						</p>
						<p>
							{{ purchase.total|amount }}
						</p>
						<p>
							{{ purchase.createdAt|format_datetime('short', 'none', locale='fr') }}
						</p>
						{% if purchase.status == statusPaid %}
							<p class="status status__paid status__paid_color_green">
								{{ purchase.status }}</p>
						{% elseif purchase.status == statusInProgress %}
							<p class="status status__in-progress status__in-progress_color_safety-orange">
								{{ purchase.status }}
							</p>
						{% elseif purchase.status == statusSend %}
							<p class="status status__send status__send_color_electric-purple">
								{{ purchase.status }}
							</p>
						{% elseif purchase.status == statusDeliver %}
							<p class="status status__deliver status__deliver_color_slimy-green">
								{{ purchase.status }}
							</p>
						{% elseif purchase.status == statusAnnul %}
							<p class="status status__annul status__annul_color_red">
								{{ purchase.status }}
							</p>
						{% endif %}
						<a class="page__link page__link-detail page__link_text-transform_uppercase page__link_margin-bottom_1em page__link_background-color_blue page__link_color_white" href="{{ path('purchase_detail', {'reference': purchase.reference}) }}">D√©tails</a>
					</div>
				{% endfor %}
				{# END : card for mobile #}
				{# START : table for desktop #}
				<table class="table table_background-color_blue table_color_white table-purchase">
					<thead>
						<tr>
							<th>R√©f√©rence</th>
							<th>Date</th>
							<th>Prix total</th>
							<th>Statut</th>
							<th>Facture</th>
							<th>Action</th>
						</tr>
					</thead>
					{% for purchase in purchases %}
						<tbody>
							<tr>
								<td>{{ purchase.reference|upper }}</td>
								<td>{{ purchase.createdAt|format_datetime('short', 'none', locale='fr') }}</td>
								<td>{{ purchase.total|amount }}</td>
								{% if purchase.status == statusPaid %}
									<td class="status status__paid status__paid_color_green">
										{{ purchase.status }}
									</td>
								{% elseif purchase.status == statusInProgress %}
									<td class="status status__in-progress status__in-progress_color_safety-orange">
										{{ purchase.status }}
									</td>
								{% elseif purchase.status == statusSend %}
									<td class="status status__send status__send_color_electric-purple">
										{{ purchase.status }}
									</td>
								{% elseif purchase.status == statusDeliver %}
									<td class="status status__deliver status__deliver_color_slimy-green">
										{{ purchase.status }}
									</td>
								{% elseif purchase.status == statusAnnul %}
									<td class="status status__annul status__annul_color_red">
										{{ purchase.status }}
									</td>
								{% endif %}
								<td>
									<a class="page__link page__link-text  page__link_font-weight_normal page__link_padding-and-margin_0 page__link_color_blue" href="#">
										Facture PDF</a>
								</td>
								<td>
									<a class="page__link page__link-detail page__link_text-transform_uppercase page__link_background-color_blue page__link_color_white" href="{{ path('purchase_detail', {'reference': purchase.reference}) }}">D√©tails</a>
								</td>
							</tr>
						</tbody>
					{% endfor %}
				</table>
			</div>
			{# END : table for desktop #}
		</section>
	</main>
{% endblock %}
{# START : purchase_list #}
